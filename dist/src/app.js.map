{"version":3,"sources":["app.js"],"names":["app","httpLogger","errorLogger","process","env","PORT","set","path","join","__dirname","use","express","static","bodyParser","urlencoded","extended","session","passport","initialize","req","res","next","id","shortid","generate","method","purchasesRouter","post","usersRouter","get","err","chalk","white","red","send","listen","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;AACA;;AACA;;;;;;AAEA,IAAIA,MAAM,wBAAV;AACA,IAAIC,aAAa,qBAAM,OAAN,CAAjB;AACA,IAAIC,cAAc,qBAAM,QAAN,CAAlB;AACAD,8CAA2CE,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAA/D;;AAEAL,IAAIM,GAAJ,CAAQ,OAAR,EAAiBC,eAAKC,IAAL,CAAUC,SAAV,EAAqB,OAArB,CAAjB;AACAT,IAAIM,GAAJ,CAAQ,aAAR,EAAuB,MAAvB;;AAEAN,IAAIU,GAAJ,CAAQC,kBAAQC,MAAR,CAAeL,eAAKC,IAAL,CAAUC,SAAV,EAAqB,QAArB,CAAf,CAAR;AACAT,IAAIU,GAAJ,CAAQG,qBAAWC,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;;AAEAf,IAAIU,GAAJ,CAAQM,eAAR;AACAhB,IAAIU,GAAJ,CAAQO,mBAASC,UAAT,EAAR;AACAlB,IAAIU,GAAJ,CAAQO,mBAASD,OAAT,EAAR;AACAhB,IAAIU,GAAJ,CAAQ,6BAAR;;AAEAV,IAAIU,GAAJ,CAAQ,UAACS,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACxBF,QAAIG,EAAJ,GAASC,kBAAQC,QAAR,EAAT;AACAvB,qBAAekB,IAAIG,EAAnB,UAA0BH,IAAIM,MAA9B,SAAwCN,IAAIZ,IAA5C;AACAc;AACH,CAJD;;AAMArB,IAAIU,GAAJ,CAAQ,YAAR,EAAqCgB,mBAArC;AACA1B,IAAI2B,IAAJ,CAAS,WAAT,EAAqCC,eAArC;AACA5B,IAAI2B,IAAJ,CAAS,QAAT,EAAqCC,eAArC;AACA5B,IAAI6B,GAAJ,CAAQ,SAAR,EAAqCD,eAArC;;AAEA5B,IAAIU,GAAJ,CAAQ,UAACoB,GAAD,EAAMX,GAAN,EAAWC,GAAX,EAAmB;AACvBlB,gBAAY6B,gBAAMC,KAAN,OAAgBb,IAAIG,EAApB,OAAZ,EAAwCS,gBAAME,GAAN,CAAUH,GAAV,CAAxC;AACAV,QAAIc,IAAJ,CAASJ,GAAT;AACH,CAHD;;AAKA9B,IAAI6B,GAAJ,CAAQ,GAAR,EAAa,UAACV,GAAD,EAAMC,GAAN,EAAc;AACvBA,QAAIc,IAAJ,CAAS,IAAT;AACH,CAFD;;AAIAlC,IAAImC,MAAJ,CAAWhC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAA/B;;AAEA+B,OAAOC,OAAP,GAAiBrC,GAAjB","file":"../app.js","sourcesContent":["import express           from 'express';\nimport path              from 'path';\nimport bodyParser        from 'body-parser';\nimport passport          from 'passport';\nimport flash             from 'express-flash';\nimport debug             from 'debug';\nimport chalk             from 'chalk';\nimport shortid           from 'shortid';\n\nimport purchasesRouter   from './controllers/purchases';\nimport usersRouter       from './controllers/users';\nimport './config/db';\nimport './config/passport';\nimport session           from './config/redis';\n\nlet app = express();\nlet httpLogger = debug('http_');\nlet errorLogger = debug('error_');\nhttpLogger(`Starting application on port ${process.env.PORT || 3000}`);\n\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\n\napp.use(express.static(path.join(__dirname, 'public')));\napp.use(bodyParser.urlencoded({ extended: false }));\n\napp.use(session);\napp.use(passport.initialize());\napp.use(passport.session());\napp.use(flash());\n\napp.use((req, res, next) => {\n    req.id = shortid.generate();\n    httpLogger(`[${req.id}] ${req.method} ${req.path}`);\n    next();\n});\n\napp.use('/purchases',                purchasesRouter);\napp.post('/register',                usersRouter);\napp.post('/login',                   usersRouter);\napp.get('/logout',                   usersRouter);\n\napp.use((err, req, res) => {\n    errorLogger(chalk.white(`[${req.id}]`), chalk.red(err));\n    res.send(err);\n});\n\napp.get('/', (req, res) => {\n    res.send('hi');\n});\n\napp.listen(process.env.PORT || 3000);\n\nmodule.exports = app;"]}